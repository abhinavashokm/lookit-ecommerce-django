{% extends 'user_base/base.html' %}
{% load static %}
{% block styles %}
<link rel="stylesheet" href="{% static 'user/css/account/address_book.css' %}">
<!--CSS for profile sidebar-->
<link rel="stylesheet" href="{% static 'user/css/components/profile_sidebar.css' %}">
 <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
{% endblock %}



{% block content %}

<!-- Main Content -->
<div class="profile-container">

    <!-- Sidebar -->
    {% include 'user_base/components/profile_sidebar.html' %}

    <!-- Main Content -->
    <main class="main-content">
        <div class="addresses-header">
            <h1 class="page-title">My Addresses</h1>
            <button class="add-address-btn" id="addAddressBtn">
                <i class="fas fa-plus"></i> Add New Address
            </button>
        </div>

        <div class="address-grid" id="addressGrid">

            <!-- Real One's -->
             {% for address in address_list %}
            <div class="address-card {% if address.is_default %}default{% endif %}">
                <div class="address-card-header">
                    <div class="address-card-title">
                        {% if address.type == 'work' %}
                        <i class="fas fa-building"></i>
                        {% else %}
                        <i class="fas fa-home"></i>
                        {% endif %}
                        
                        <span>{{ address.type }}</span>

                        {% if address.is_default %}
                        <span class="default-badge">Default</span>
                        {% endif %}
                    </div>
                    <div class="address-actions">
                        <a href="{% url 'set-default-address'  address.id  %}">
                            <button class="address-action-btn set-default" data-id="3">
                                <i class="fas fa-check-circle"></i>
                            </button>
                        </a>
                        <button onclick="openEditAddressModal('{{ address.id }}')" class="address-action-btn edit-address" data-id="3">
                            <i class="far fa-edit"></i>
                        </button>

                            <button id="{{ address.id }}" onclick="openDeleteModal('{{ address.id }}')" class="address-action-btn delete-address" data-id="3">
                                <i class="far fa-trash-alt"></i>
                            </button>

                    </div>
                </div>
                <div class="address-details">
                    <p>{{ address.full_name }}</p>
                    <p>{{ address.address_line }}</p>
                    <p>{{ address.city }}, Pin: {{ address.pincode }}</p>
                    <p>{{ address.state }}</p>
                    <p class="address-phone">
                        <i class="fas fa-phone-alt"></i> {{ address.phone }}{% if address.second_phone %}, {{ address.second_phone }}{% endif %}
                    </p>
                </div>
            </div>
                <!-- Delete Confirmation Modal -->
                <div class="delete-modal-overlay" id="deleteModal{{ address.id }}">
                    <div class="delete-modal">
                        <div class="delete-modal-header">
                            <h2 class="delete-modal-title">Delete Address</h2>
                        </div>
                        <div class="delete-modal-body">
                            <p class="modal-message">Are you sure you want to delete this address? This action cannot be undone and the
                                address will be
                                permanently
                                removed.</p>
                        </div>
                        <div class="delete-modal-actions">
                            <button class="delete-modal-btn delete-modal-btn-cancel" onclick="closeDeleteModal('{{ address.id }}')">Cancel</button>

                            <form action="{% url 'delete-address' %}" method="post">
                                {% csrf_token %}
                                <input type="hidden" name="address_id" value="{{ address.id }}">
                                <input type="hidden" name="request_from" value="address_book">
                                    <button class="delete-modal-btn delete-modal-btn-confirm" onclick="confirmDelete()">Delete</button>
                            </form>

                        </div>
                    </div>
                </div>

                <!-- Edit Address Modal -->
                <div class="modal" id="editAddressModal{{ address.id }}">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h3><i class="fas fa-map-marker-alt"></i> <span id="modalTitle">Add New Address</span></h3>
                            <button onclick="closeEditAddressModal('{{ address.id }}')" class="close-modal" id="closeModal">&times;</button>
                        </div>
                        <div class="modal-body">

                            <form id="addressForm" action="{% url 'edit-address' %}" method="post">
                                {% csrf_token %}
                                <input type="hidden" value="address_book" name="page_from">
                                <input type="hidden" id="addressId" name="address_id" value="{{ address.id }}">
                                
                                <div class="form-section">
                                    <h4 class="section-title">
                                        <i class="far fa-address-card"></i> Contact Information
                                    </h4>
                                    <div class="form-grid">
                                        <div class="form-group">
                                            <label for="fullName">Full Name *</label>
                                            <input type="text" id="fullName" name="full_name" value="{{ address.full_name }}" required>
                                        </div>
                                        <div class="form-group">
                                            <label for="phoneNumber">Phone Number *</label>
                                            <input type="tel" id="phoneNumber" name="phone" value="{{ address.phone }}" required>
                                        </div>
                                        <div class="form-group">
                                            <label for="phoneNumber">Second Phone Number (Optional)</label>
                                            <input type="tel" id="phoneNumber" name="second_phone" value="{{ address.second_phone }}">
                                        </div>
                                    </div>
                                </div>

                                <div class="form-section">
                                    <h4 class="section-title">
                                        <i class="fas fa-map-marked-alt"></i> Address
                                    </h4>
                                    <div class="form-group">
                                        <label for="addressLine1">Address Line*</label>
                                        <input type="text" id="addressLine1" name="address_line" value="{{ address.address_line }}" required>
                                    </div>
                                    <div class="form-grid">
                                        <div class="form-group">
                                            <label for="city">City *</label>
                                            <input type="text" id="city" name="city" value="{{ address.city }}" required>
                                        </div>
                                        <div class="form-group">
                                            <label for="state">State/Province *</label>
                                            <input type="text" id="state" name="state" value="{{ address.city }}" required>
                                        </div>
                                    </div>
                                    <div class="form-grid">
                                        <div class="form-group">
                                            <label for="postalCode">Postal Code *</label>
                                            <input type="number" id="postalCode" name="pincode" value="{{ address.pincode }}" required>
                                        </div>
                                    </div>
                                </div>

                                <div class="form-section">
                                    <h4 class="section-title">
                                        <i class="fas fa-tag"></i> Address Label
                                    </h4>
                                    <div class="form-group">
                                        <div class="address-labels">
                                            <label class="radio-container">
                                                <input type="radio" name="type" value="home" {% if address.type == 'home' %}checked{% endif %}>
                                                <span class="radio-checkmark"></span>
                                                <span class="radio-label">
                                                    <i class="fas fa-home"></i> Home
                                                </span>
                                            </label>
                                            <label class="radio-container">
                                                <input type="radio" name="type" value="work" {% if address.type == 'work' %}checked{% endif %}>
                                                <span class="radio-checkmark"></span>
                                                <span class="radio-label">
                                                    <i class="fas fa-building"></i> Work
                                                </span>
                                            </label>
                                            <label class="radio-container">
                                                <input type="radio" name="type" value="other" {% if address.type == 'other' %}checked{% endif %}>
                                                <span class="radio-checkmark"></span>
                                                <span class="radio-label">
                                                    <i class="fas fa-map-marker-alt"></i> Other
                                                </span>
                                            </label>
                                            <div class="custom-label" style="display: none;">
                                                <input type="text" id="customLabel" placeholder="Enter custom label">
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="form-options">
                                    <label class="checkbox-container">
                                        <input type="checkbox" name="is_default" id="setAsDefault" value="True" {% if address.is_default %}checked{% endif %}>
                                        <span class="checkmark"></span>
                                        <span>Set as default address</span>
                                    </label>
                                </div>

                                <div class="form-actions">
                                    <button onclick="closeEditAddressModal('{{ address.id }}')" type="button" class="btn btn-outline" id="cancelBtn">Cancel</button>
                                    <button type="submit" class="btn btn-primary">Save Address</button>
                                </div>
                            </form>

                        </div>
                    </div>
                </div>
            {% endfor %}



        </div>
    </main>

</div>

<!-- Add Address Modal -->
<div class="modal" id="addressModal">
    <div class="modal-content">
        <div class="modal-header">
            <h3><i class="fas fa-map-marker-alt"></i> <span id="modalTitle">Add New Address</span></h3>
            <button onclick="closeModalHandler()" class="close-modal" id="closeModal">&times;</button>
        </div>
        <div class="modal-body">

            <form id="addressForm" action="{% url 'add-address' %}" method="post">
                {% csrf_token %}
                <input type="hidden" value="address_book" name="page_from">
                <input type="hidden" id="addressId">
                
                <div class="form-section">
                    <h4 class="section-title">
                        <i class="far fa-address-card"></i> Contact Information
                    </h4>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="fullName">Full Name *</label>
                            <input type="text" id="fullName" name="full_name" required>
                        </div>
                        <div class="form-group">
                            <label for="phoneNumber">Phone Number *</label>
                            <input type="tel" id="phoneNumber" name="phone" required>
                        </div>
                        <div class="form-group">
                            <label for="phoneNumber">Second Phone Number (Optional)</label>
                            <input type="tel" id="phoneNumber" name="second_phone">
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <h4 class="section-title">
                        <i class="fas fa-map-marked-alt"></i> Address
                    </h4>
                    <div class="form-group">
                        <label for="addressLine1">Address Line*</label>
                        <input type="text" id="addressLine1" name="address_line" required>
                    </div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="city">City *</label>
                            <input type="text" id="city" name="city" required>
                        </div>
                        <div class="form-group">
                            <label for="state">State/Province *</label>
                            <input type="text" id="state" name="state" required>
                        </div>
                    </div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="postalCode">Postal Code *</label>
                            <input type="number" id="postalCode" name="pincode" required>
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <h4 class="section-title">
                        <i class="fas fa-tag"></i> Address Label
                    </h4>
                    <div class="form-group">
                        <div class="address-labels">
                            <label class="radio-container">
                                <input type="radio" name="type" value="home" checked>
                                <span class="radio-checkmark"></span>
                                <span class="radio-label">
                                    <i class="fas fa-home"></i> Home
                                </span>
                            </label>
                            <label class="radio-container">
                                <input type="radio" name="type" value="work">
                                <span class="radio-checkmark"></span>
                                <span class="radio-label">
                                    <i class="fas fa-building"></i> Work
                                </span>
                            </label>
                            <label class="radio-container">
                                <input type="radio" name="type" value="other">
                                <span class="radio-checkmark"></span>
                                <span class="radio-label">
                                    <i class="fas fa-map-marker-alt"></i> Other
                                </span>
                            </label>
                            <div class="custom-label" style="display: none;">
                                <input type="text" id="customLabel" placeholder="Enter custom label">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="form-options">
                    <label class="checkbox-container">
                        <input type="checkbox" name="is_default" value="True" id="setAsDefault">
                        <span class="checkmark"></span>
                        <span>Set as default address</span>
                    </label>
                </div>

                <div class="form-actions">
                    <button onclick="closeModalHandler()"  type="button" class="btn btn-outline" id="cancelBtn">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Address</button>
                </div>
            </form>

        </div>
    </div>
</div>


{% endblock %}

{% block scripts %}
<script src="{% static 'user/js/account/address_book.js' %}"></script>
{% endblock %}